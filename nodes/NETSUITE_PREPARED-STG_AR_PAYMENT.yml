fileVersion: 1
id: 9591bed7-4776-4f63-b983-f5816f6274f2
name: STG_AR_PAYMENT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: NETSUITE_PREPARED
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4d0dce1-1127-4422-94e5-f63ee896f8bc
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TRANSACTION_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 999a68e5-533d-477c-9ad9-dbac6a43cd47
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1beb29c-f323-41b5-8ba2-6a795405c509
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: CLOSEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65f9efe9-7e7a-49d7-bff3-e88a543291b9
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ae167be-6dda-4ba2-a029-0b25e251eda9
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a7b6420-b567-4e0b-b80c-c08b0feb8fd0
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bebe2433-81fd-48f7-97b6-b117c180e726
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: DAYSOPEN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5971a1d-8be1-4622-97fd-154b6437fbe2
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9ec0b2a-23cf-4559-ad81-ab4139e3409d
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee6825a4-1a91-4b79-b401-4ef8ad04a6f8
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8260f3aa-59c1-46f5-a610-8ebf4b609369
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: FLOAT
        description: ""
        name: EXCHANGERATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 314c3402-b342-4ac6-b1a4-4e281efe5e5f
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 234590e7-91fe-43d6-8053-60415d59079f
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: FLOAT
        description: ""
        name: TRANSACTION_FOREIGNTOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a26cd3c-6c3e-4c03-9a39-93a425a77b78
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15558210-70dc-40c8-861b-156bba9d09aa
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR(32000)
        description: ""
        name: TRANSACTION_MEMO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b459c1d-8d59-4e7f-84e7-40a664cf2ba9
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f85c22d5-27b9-43ad-8899-e7233d11ae09
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: POSTING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a9876e5-8f00-43f5-9f1a-12598d8b324f
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ba2cb70-9263-42aa-9f49-81ea083b583f
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: POSTINGPERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a34e5e4-64f0-46a9-a214-b0dc0b7f06b8
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80e79805-c7f3-4a92-b035-3df0be73a27c
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: TRANDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 922f8a2c-0837-40c6-bafd-45a25a17feb2
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74140d38-8f71-4e32-ae23-9fbf67cf5f6a
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR(9112)
        description: ""
        name: TRANDISPLAYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e506fad-37f3-4bcb-b021-3e733b922a6e
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e64fcb85-8899-46fe-be15-2f0489de0518
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR(360)
        description: ""
        name: DOCUMENT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a6f36eb-4700-4158-a095-dfa27b54c3e1
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a4453aa-144f-49bf-9810-3c56d32a883a
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96ab1be0-7226-4097-92a9-e5fc10a1ad29
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1f9013a-b9c5-4163-b283-f23d2af8e8a2
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: VOID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4248e1e-39e4-4161-bfd2-226c3e40db6c
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49a23bfd-1aa5-4b4d-9027-115c1a3d5c22
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: VOIDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d67e0813-0b0c-46d8-8319-5d3790380c13
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c8cfbee-0226-4f15-b765-1e18622b25d2
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TL_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29072cb0-70eb-4d9f-83b3-8bcbb79bdc04
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eab8e3b2-fe5d-497b-9dea-0e61637682d7
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR(240)
        description: ""
        name: ACCOUNTINGLINETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85f21560-3907-4132-a508-4bb7c67705f2
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4586ed80-2e95-433c-98fb-efebfd16c08a
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CLASS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d875f90-18d6-4da2-9821-e0d5541e10c6
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dc04b4d-c3a9-4594-a3ae-89dde7b1343a
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: CLEARED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e141588-6e3e-4bb6-94cb-9d76a9f8234a
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c086308-28b4-46de-88e7-6bde9be34e50
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CREATEDFROM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0b33d16-52dc-423d-9247-c3b8f693d59a
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f803a4d-235f-41f5-acca-75eb5987b476
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: TL_ENTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee6825a4-1a91-4b79-b401-4ef8ad04a6f8
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 232173b7-81d5-4af3-b1f5-5eef5a14a3df
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a3cef65-9786-45c6-8f88-af07a78212bf
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71a0b09a-4581-4442-9fc2-50f2047d9eca
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: FLOAT
        description: ""
        name: TL_FOREIGNAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19069981-2fb3-4805-8050-9eb7f789a31f
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d476dd61-f7ad-4792-82fc-c15a302bfa0a
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: ISCLOSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a40c7a18-b19e-4fbf-b59e-cc6a18431f3f
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0913b5d0-2462-4a2d-9657-b0d1d5a0c058
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR(32000)
        description: ""
        name: TL_MEMO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7386cbdf-701b-4e44-a3ab-7480c4a6552f
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 569ce15b-ef52-4333-ad1b-51b7e1ce00e1
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: FLOAT
        description: ""
        name: NETAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c000bb4-353a-47a2-9dd2-04ff561fefaa
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: deb1a107-aeb1-4a38-9820-86ffa60ca720
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SUBSIDIARY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dab44d41-1d45-44c9-879c-1676e1f66625
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 034b7810-3374-428f-ad79-fb4275718184
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: LINE_SEQUENCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45b33a3a-82bc-4350-8bf8-d4b7d8510696
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 589f1ce4-28ba-4b21-bab2-7aeca9963c3f
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: TL_UNIQUE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b02c2ac6-20e2-4455-92f7-d26852eae811
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1b15df75-7db7-4457-88c6-47cd54ee9d35
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: REAL_ESTATE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e1ae042-3bf3-4a6a-b26c-55e54983f47e
                stepCounter: 80ac8310-eaee-4fea-b3b2-368e513f27fc
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3f730f9d-52be-460e-82d8-8bc5fa462444
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: TL_LINESEQUENCENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45b33a3a-82bc-4350-8bf8-d4b7d8510696
                stepCounter: ab3fb650-78a3-4be2-a523-cd73d32ab66c
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0b186569-eff1-43d5-a7f1-9e6e515a9f8e
          stepCounter: 9591bed7-4776-4f63-b983-f5816f6274f2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: TRANSACTION_STATUS_CLEANED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE WHEN  ("STG_TRANSACTION"."TYPE" = 'CustInvc' or  "STG_TRANSACTION"."TYPE" = 'CustCred') and "STG_TRANSACTION"."STATUS" = 'A' THEN 'Open' WHEN  "STG_TRANSACTION"."TYPE" = 'CustDep' and "STG_TRANSACTION"."STATUS" = 'A' THEN 'Not Deposited' WHEN  "STG_TRANSACTION"."TYPE" = 'CustCred' and "STG_TRANSACTION"."STATUS" = 'B' THEN 'Fully applied' WHEN  "STG_TRANSACTION"."TYPE" = 'CustInvc' and "STG_TRANSACTION"."STATUS" = 'B' THEN 'Invoice Paid in Full' WHEN  "STG_TRANSACTION"."TYPE" = 'CustDep' and "STG_TRANSACTION"."STATUS" = 'C' THEN 'Deposit Fully Applied' ELSE NULL END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_TRANSACTION: 80ac8310-eaee-4fea-b3b2-368e513f27fc
          STG_TRANSACTIONLINE: ab3fb650-78a3-4be2-a523-cd73d32ab66c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: NETSUITE_PREPARED
            nodeName: STG_TRANSACTION
          - locationName: NETSUITE_PREPARED
            nodeName: STG_TRANSACTIONLINE
        join:
          joinCondition: |-
            FROM {{ ref('NETSUITE_PREPARED', 'STG_TRANSACTION') }} "STG_TRANSACTION"
            INNER JOIN {{ ref('NETSUITE_PREPARED', 'STG_TRANSACTIONLINE') }} "STG_TRANSACTIONLINE"
                ON "STG_TRANSACTION"."ID" = "STG_TRANSACTIONLINE"."TRANSACTION"
            WHERE "STG_TRANSACTION"."TYPE" IN ('CustPymt', 'DepAppl', 'Journal')
                AND "STG_TRANSACTIONLINE"."ACCOUNTINGLINETYPE" = 'ACCOUNTSRECEIVABLE'
        name: STG_AR_PAYMENT
        noLinkRefs: []
  name: STG_AR_PAYMENT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
